This is chapter 3 plus some new changes